"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5368],{5368:(Y,f,n)=>{n.r(f),n.d(f,{AccountDeletePageModule:()=>j});var C=n(6814),D=n(95),l=n(7311),A=n(2129),g=n(5861),O=n(4711),P=n(6346),v=n(9862),t=n(6689),T=n(2014),Z=n(2333),w=n(6882);const M=[{path:"",component:(()=>{class o{constructor(e,s,r,c,y,a,i){this.router=e,this.storage=s,this.authService=r,this.auth=c,this.loadingController=y,this.alertController=a,this.http=i,this.user=null,this.isModalOpen=!1,this.isModalClose=!0}ngOnInit(){var e=this;return(0,g.Z)(function*(){yield e.storage.create(),e.log=yield e.storage.get("log"),e.username=yield e.storage.get("username"),e.user_email=yield e.storage.get("email"),e.appleid=yield e.storage.get("appleid"),e.apple_email=yield e.storage.get("apple_email"),e.uid=yield e.storage.get("userid"),yield O.c.hide()})()}signOut(){var e=this;return(0,g.Z)(function*(){null!=e.username?(yield P.e.signOut(),yield e.storage.remove("username"),yield e.storage.remove("userState"),e.router.navigateByUrl("login")):null!=e.user_email?(yield e.authService.logout(),yield e.storage.remove("email"),e.router.navigateByUrl("login")):null!=e.appleid?(e.auth.signOut(),yield e.storage.remove("appleid"),yield e.storage.remove("apple_email"),yield e.storage.remove("userState"),e.router.navigateByUrl("login")):console.log("Signout Error Occured")})()}setClose(){this.router.navigateByUrl("menu/home")}showAlert(e,s){var r=this;return(0,g.Z)(function*(){yield(yield r.alertController.create({header:"Account deletion processing",message:s,buttons:["Okay"]})).present()})()}deleteAccount(){var e=this;return(0,g.Z)(function*(){var r;yield(yield e.alertController.create({header:"Confirm Account Deletion",message:"Are you sure you want to delete your account?",buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",handler:(r=(0,g.Z)(function*(){var c;if(null!==(c=e.auth.currentUser)&&void 0!==c&&c.uid){var y;const i=yield e.loadingController.create();yield i.present(),(a=new Headers).append("Accept","application/json"),a.append("Content-Type","application/json");const S={headers:new v.WM({"Content-Type":"application/json"})},m={user_id:null===(y=e.auth.currentUser)||void 0===y?void 0:y.uid};e.http.post("https://casa.evokemusic.net/api/deactivate",JSON.stringify(m),S).subscribe({next:d=>{e.adRespons=d},error:d=>console.error(d),complete:()=>{e.showAlert("","Your account will be deleted within 30 days"),console.log("Casa Account deleted",e.adRespons)}}),yield e.storage.remove("userid"),yield i.dismiss(),yield e.signOut()}else if(e.username.id){const i=yield e.loadingController.create();yield i.present(),(a=new Headers).append("Accept","application/json"),a.append("Content-Type","application/json");const h={headers:new v.WM({"Content-Type":"application/json"})};e.http.post("https://casa.evokemusic.net/api/deactivate",JSON.stringify({user_id:e.username.id}),h).subscribe({next:u=>{e.adRespons=u},error:u=>console.error(u),complete:()=>{e.showAlert("","Your account will be deleted within 30 days"),console.log("Google Account deleted",e.adRespons)}}),yield e.storage.remove("username"),yield e.storage.remove("gmailid"),yield i.dismiss(),yield e.signOut()}else{const i=yield e.loadingController.create();var a;yield i.present(),(a=new Headers).append("Accept","application/json"),a.append("Content-Type","application/json");const h={headers:new v.WM({"Content-Type":"application/json"})};e.http.post("https://casa.evokemusic.net/api/deactivate",JSON.stringify({user_id:e.appleid}),h).subscribe({next:u=>{e.adRespons=u},error:u=>console.error(u),complete:()=>{e.showAlert("","Your account will be deleted within 30 days"),console.log("Apple Account deleted",e.adRespons)}}),yield i.dismiss(),yield e.signOut()}}),function(){return r.apply(this,arguments)})}]})).present()})()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A.F0),t.Y36(T.K),t.Y36(Z.e),t.Y36(w.gx),t.Y36(l.HT),t.Y36(l.Br),t.Y36(v.eN))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-account-delete"]],decls:17,vars:0,consts:[["translcant","true"],["slot","start"],[3,"click"],[1,"ion-padding"],["color","light",2,"position","static"],[2,"text-align","justify"],["size","small","expand","block","shape","round","color","danger",2,"width","150px",3,"click"]],template:function(e,s){1&e&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),t.NdJ("click",function(){return s.setClose()}),t._uU(4,"Back"),t.qZA()()()(),t.TgZ(5,"ion-content",3)(6,"ion-card",4)(7,"ion-card-content")(8,"ion-label")(9,"p",5),t._uU(10," All your user data and account will be permenantly deactivated and deleted within 30 days. You will be automatically signed out & redirected to login page. "),t.qZA(),t._UZ(11,"br"),t.TgZ(12,"p"),t._uU(13," Hope to see you again in CASA App. "),t.qZA()(),t._UZ(14,"br"),t.TgZ(15,"ion-button",6),t.NdJ("click",function(){return s.deleteAccount()}),t._uU(16,"Delete Account"),t.qZA()()()())},dependencies:[l.YG,l.Sm,l.PM,l.FN,l.W2,l.Gu,l.Q$,l.sr]}),o})()}];let b=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[A.Bz.forChild(M),A.Bz]}),o})(),j=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[C.ez,D.u5,l.Pc,b]}),o})()}}]);